<!DOCTYPE html>
<html>
	<head>
		<title>Test Form</title>
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
		<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
		<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/knockout/3.0.0/knockout-min.js"></script>
		<style type="text/css">
			body {
				padding-top: 60px;
				height: 100%;
			}
			section {
				padding-top: 60px;
				margin-top: -60px;
			}
			.content > section > p {
				background-color: #f5f5f5;
				height: 570px;
			}
			#infobar {
				display: table;
				border-spacing: 5px;
			}
			.infobar_zero {
				margin: 0;
				padding: 2px;
			}
			#infobar i {
				position: absolute;
				top: 4px;
				right: 2px;
			}
			#infobar_content {
				display: table-row;
			}
			#infobar_content > div {
				display: table-cell;
			}
			#infobar_left {
				border: 1px solid rgb(211,211,211);
				border-radius: 4px;
				padding: 2px;
			}
			/* shamelessly ripped from css3please.com */
			/* 	ie's rotate macro thing before ie9 has an unescaped colon in it
				and it breaks my css */
			.box-rotate {
     			-moz-transform: rotate(-90deg);  /* ff3.5+ */
       			-o-transform: rotate(-90deg);  /* opera 10.5 */
  				-webkit-transform: rotate(-90deg);  /* safari 3.1+, chrome */
  				-ms-transform: rotate(-90deg); /* ie9 */
  				transform: rotate(-90deg); /* else */
			}
			/*	the box-rotate style breaks positioning
				and this kind of brings it back */
			.tab-pos {
				-webkit-transform-origin: 25% 217%; /* this is crazy! */
				-moz-transform-origin: 25% 217%; /* crazy, i tell you! */
				-o-transform-origin: 25% 217%;
				-ms-transform-origin: 25% 217%;
				transform-origin: 25% 217%;
				width: 120px;
				font-size: 12pt;
				padding: 10px;
				text-align: center;
			}
            .Copper {
                background-color: #B87333;
            }
            .Bronze {
                background-color: #CD7F32;
            }
            .Silver {
                background-color: #C0C0C0;
            }
            .Gold {
                background-color: #D4A017;
            }
            .Platinum {
                background-color: #E5E4E2;
            }
            .select_package {
                cursor: pointer;
                cursor: hand;
            }
            .package_features {
                border:2px solid;
                border-color: #B6B6B4;
            }
            .purchase_items {
                border:2px solid;
                border-color: #B6B6B4;
            }
		</style>
{% include 'templates/customer_info.html' %}
{% include 'templates/customize.html' %}
{% include 'templates/combos.html' %}
{% include 'templates/packages.html' %}
{% include 'templates/premium_add_ons.html' %}
{% include 'templates/publish.html' %}
{% include 'templates/closing.html' %}
{% include 'templates/services.html' %}
{% include 'templates/shipping.html' %}
	</head>
	<body>
		<div class="affix" style="top:40px;right:0px">
			<div id="infobar" class="well">
				<i id="infobar_resize" class="icon-resize-small"></i>
				<div id="infobar_content">
					<div id="infobar_left">
						<span data-bind="text: dat.blob.name"></span><br>
						<span data-bind="text: dat.blob.address"></span><br>
						<span data-bind="text: dat.blob.city"></span>,
						<span data-bind="text: dat.blob.state"></span><br>
						<span data-bind="text: dat.blob.zip"></span><br>
					</div>
					<div id="infobar_middle">
						<p>
							<span class="label label-default">$Invoice</span><br>
							<span class="label label-important">Chargeback</span><br>
							<span class="label label-info">Combos</span><br>
							<span class="label label-warning">Promotions</span><br>
							<span class="label label-success">Rate Drops</span><br>
						</p>
					</div>
					<div id="infobar_right">
						<p>
							<span class="label label-default">Agreement ID</span><br>
							<span class="label label-important">Package</span><br>
							<span class="label label-info">Monitoring</span><br>
							<span class="label label-warning">Shipping</span><br>
							<span class="label label-success">$RMR</span><br>
						</p>
					</div>
				</div>
			</div>
		</div>
		<div class="container">
			<div class="navbar navbar-fixed-top" id="navbar">
				<div class="navbar-inner">
					<ul class="nav">
						<li><a href="#cinfo">Customer Info</a></li>
						<li><a href="#pkgsel">Package/Monitoring Select</a></li>
						<li><a href="#premium">Premium Add-Ons</a></li>
						<li><a href="#combos">Combos</a></li>
						<li><a href="#custom">Customize</a></li>
						<li><a href="#services">Services</a></li>
						<li><a href="#closing">Closing</a></li>
						<li><a href="#shipping">Shipping</a></li>
						<li><a href="#publish">Publish</a></li>
					</ul>
				</div>
			</div>
			<div class="content">
				<section id="cinfo">
					<div data-bind="template: { name: 'customer_info', data: dat }">Customer Info Form</div>
				</section>
				<section id="pkgsel">
					<div data-bind="template: { name: 'packages', data: dat }">Package Select Form</div>
				</section>
				<section id="premium">
					<div data-bind="template: { name: 'premiums', data: dat }">Premium Form</div>
				</section>
				<section id="combos">
					<div data-bind="template: { name: 'combos_', data: dat }">Combo Select Form</div>
				</section>
				<section id="custom"><p>Customize Form</p></section>
				<section id="services">
					<div data-bind="template: { name: 'services_', data: dat }">Services Form</div>
				</section>
				<section id="closing">
					<div data-bind="template: { name: 'closing_', data: dat }">Closing Form</p>
				</section>
				<section id="shipping">
					<div data-bind="template: { name: 'shipping_', data: dat }">Rate Drop Form</div>
				</section>
				<section id="publish">
					<div data-bind="template: { name: 'publish_', data: dat }">Publish Form</div>
				</section>
				<section id="scroller">
					<p>this scroll buffer makes sure publish is at the top of the page when the scroll is all the way at the bottom</p>
				</section>
			</div>
		</div>
		<script type="text/javascript">
			// jquery wrapper to anonymous function
			$(function() {
				var blob = {};

				// AJAX JSON LOADER

				var result = $.ajax({
					dataType: "json",
					url: '/json',
					async: false, // asynchronous load means empty blob
					success: function() { console.log("loaded json"); }
				});

				// populate blob with keys and ko.observable values
				result.done(function(data) {
					$.each(data, function(k, v) {
						blob[k] = ko.observable(v);
					});
				});

				// KNOCKOUT TEMPLATES

				// initialize a view model
				function TrashboardVM(blob) {
					// capture 'this' into this function's closure
					var self = this;

					// make blob a thing if it isn't
					var blob = blob || {};

					// declare things that should be visible to templates
					self.dat = {	blob: blob,
									countries: ["USA"].concat(["Canada"].sort()), // sort everyone else
									states: ["AK", "CA", "HI", "TX"].sort(), // sort states
								};
				}

				// apply bindings for knockout
				ko.applyBindings(new TrashboardVM(blob));

				// SCROLL SPY

				// scrollspy to activate elements in the navbar when they are visible
				$('body').scrollspy({target: '#navbar', offset: 65});

				// JQUERY DOM MANIPS

				// toggle the info bar
				$('#infobar_resize').click(function(e) {
					$('#infobar_content').toggle();
					$('#infobar').toggleClass("infobar_zero");
					$('#infobar_resize').toggleClass("icon-resize-small icon-resize-full");
				});
				// toggle the info bar resize icon on hover
				$('#infobar_resize').hover(function() {
					$(this).toggleClass("icon-white");
				}, function() {
					$(this).toggleClass("icon-white");
				});

				// JQUERY FORM-SPECIFIC MANIPS

				// customer info
				// select the correct credit button
				var credit_str = "<a class='btn btn-large ";
				if (blob.approved() == 'approved') { credit_str += "btn-success'><i class='icon-ok icon-white'></i> Approved</a>"; };
				if (blob.approved() == 'dcs') { credit_str += "btn-danger'><i class='icon-remove icon-white'></i> Approved DCS</a>"; };
				if (blob.approved() == 'no hit') { credit_str += "btn-warning'><i class='icon-warning-sign icon-white'></i> No Hit</a>"; };
				$('#credit_btn').empty().append(credit_str);

				// packages
				// bind some click events
	            $('.select_package').on('click', function(evt) {
	                evt.preventDefault();
	                var $this = $(this);
	                var pack = $this.data('package');
	                $('.show_package').hide();
	                $('#' + pack).slideToggle("slow");
	                package_data["package"] = pack
	                console.log(package_data);
	                //CustomizeModel(pack);
	            });

	            $('.customize').on('click', function(evt) {
	                evt.preventDefault();
	                var $this = $(this);
	                $this.hide();
	                var detail = $this.data('detail');
	                $('.pckg_detail').slideToggle("slow");
	                $('.cust_pckg').slideToggle("slow");
	            });

	            $('.cancel_purchase').on('click', function(evt) {
	                $('.purchase').slideToggle("slow");
	                $('.customize').slideToggle("slow");
	            });

	            $('.add_purchase').on('click', function(evt) {
	                $('.cust_pckg').slideToggle("slow");
	                $('.customize').slideToggle("slow");
	            });

	            $('.expand_equip').on('click', function(evt) {
	                var $this = $(this);
	                var sec = $this.data('equip');
	                $this.hide();
	                $('#' + sec).slideToggle("slow");
	                $('#hide' + sec).slideToggle("slow");
	            });

	            $('.hide_equip').on('click', function(evt) {
	                var $this = $(this);
	                var sec = $this.data('equip');
	                $this.hide();
	                $('#' + sec).slideToggle("slow");
	                $('#expand' + sec).slideToggle("slow");
	            });

	            $('.checkbox').on('change', function(evt) {
	                var $this = $(this);
	            });

			});
		</script>
	</body>
</html>
.